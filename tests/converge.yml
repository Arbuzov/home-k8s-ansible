---
- name: Test Ansible roles
  hosts: all
  become: yes
  gather_facts: yes

  pre_tasks:
    - name: Load test credentials
      set_fact:
        credentials: "{{ lookup('file', '/tmp/credentials.json') | from_json }}"

  roles:
    - role: ../roles/common
      tags: [common]
      
  post_tasks:
    - name: Verify common role execution
      debug:
        msg: "Common role applied successfully"
